/*!
 * @copyright 2015 AI428
 * @description for multi gestures
 * @license http://opensource.org/licenses/MIT
 * @namespace Mist
 * @version 0.1.0
 */
function mist(t){return Mist.Component.create(Mist.Statement,t)}var Mist;!function(t){var e=function(){function t(){}return t.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=this.hash(e),o=this.hash([t]);return this.components[o]||(this.components[o]={}),this.components[o][r]||(this.components[o][r]=new(t.bind.apply(t,[t].concat([].slice.apply(e))))),this.components[o][r]},t.hash=function(t){var e=this;return JSON.stringify(t.map(function(t){return t instanceof Element&&t.id?t.id:t instanceof Object?t._ID||(t._ID=e.identities.push(0)):t}))},t.components={},t.identities=[],t}();t.Component=e}(Mist||(Mist={}));var Mist;!function(t){var e=function(){function t(t){var e=this;this.resolver=function(t){e.resolver.statement?e.resolver.statement(t):e.resolver.completor=function(){e.resolver(t)}},this.rejector=t.rejector||function(t){e.rejector.statement?e.rejector.statement(t):e.rejector.completor=function(){e.rejector(t)}},t(this.resolver,this.rejector)}return t.prototype["catch"]=function(e){var n=this,r=function(t,e){r.resolver=t,r.rejector=t,n.rejector.completor&&n.rejector.completor()};return this.rejector.statement=function(t){try{var n=e(t);null!=n&&r.resolver(n)}catch(o){r.rejector(o)}},new t(r)},t.prototype.then=function(e,n){var r=this,o=function(t){o.resolver=t,r.resolver.completor&&r.resolver.completor()};return o.rejector=this.rejector,this.resolver.statement=function(t){try{var r=e(t);null!=r&&o.resolver(r)}catch(i){if(n){var r=n(i);null!=r&&o.resolver(r)}else o.rejector(i)}},new t(o)},t}();t.Promise=e}(Mist||(Mist={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},Mist;!function(t){var e=function(t){function e(){var e=this;t.call(this,function(t,n){e.compute=function(r){if(!e.paused)try{t(r)}catch(o){n(o)}}})}return __extends(e,t),e.prototype.pause=function(){this.paused=!0},e.prototype.resume=function(){this.paused=!1},e}(t.Promise);t.Listener=e}(Mist||(Mist={}));var Mist;!function(t){var e=function(){function t(t){this.statement=t}return t.prototype.add=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this.statement.each(function(e){e.classList.add.apply(e.classList,t)})},t.prototype.remove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this.statement.each(function(e){e.classList.remove.apply(e.classList,t)})},t.prototype.toggle=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this.statement.each(function(e){t.forEach(function(t){e.classList.toggle(t)})})},t}();t.CSSClass=e}(Mist||(Mist={}));var Mist;!function(t){var e=function(t){function e(e){var n=this;this.composite=e,t.call(this,function(t,e){n.compute=function(){n.computed||(n.computed=!0,requestAnimationFrame(function(){try{t(n.composite)}catch(r){e(r)}finally{n.computed=!1}}))}})}return __extends(e,t),e.prototype.compose=function(t){this.composite=t(this.composite),this.compute()},e}(t.Promise);t.Value=e}(Mist||(Mist={}));var Mist;!function(t){var e=function(){function e(e){this.value=new t.Value({}),this.value.then(function(t){e.each(function(e){for(var n in t)e.style.hasOwnProperty(n)&&(e.style[n]=t[n])}),t={}})}return e.prototype.remove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this.value.compose(function(e){return t.forEach(function(t){e[t]=""}),e})},e.prototype.set=function(t){this.value.compose(function(e){for(var n in t)e[n]=t[n];return e})},e}();t.CSSStyle=e}(Mist||(Mist={}));var Mist;!function(t){var e=function(){function e(){this.listeners=[]}return e.prototype.add=function(t){this.listeners.forEach(function(e){e.compute(t)})},e.prototype.cancel=function(t){var e=this.listeners.indexOf(t);0>e||this.listeners.splice(e,1)},e.prototype.initialize=function(){},e.prototype.listen=function(){var e=new t.Listener;return this.listeners.length||this.initialize(),this.listeners.push(e),e},e}();t.Stream=e}(Mist||(Mist={}));var Mist;!function(t){var e=function(t){function e(e){var n=this;t.call(this);var r=[];this.initialize=function(){var t=e.length;e.map(function(e,o){e.then(function(e){r[o]=e,r.length==t&&n.add(r),r.length==t&&(r=[])})})}}return __extends(e,t),e}(t.Stream);t.All=e}(Mist||(Mist={})),function(t){t.matches=t.matches||t.mozMatchesSelector||t.msMatchesSelector||t.webkitMatchesSelector}(Element.prototype),function(t){t.closest=t.closest||function(t){for(var e=this;e&&!e.matches(t);)e=e.parentElement;return e}}(Element.prototype);var Mist;!function(t){var e=function(t){function e(e,n){var r=this;t.call(this),document.addEventListener(e,function(t){var e=t.target;e instanceof Element&&e.closest(n)&&r.add(t instanceof CustomEvent?t.detail:t)})}return __extends(e,t),e.customize=function(t,e){var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles||!0,e.cancelable||!0,e.detail),n},e}(t.Stream);t.Emitter=e}(Mist||(Mist={}));var Mist;!function(t){var e=function(e){function n(n){var r=this;e.call(this);var o=[];this.initialize=function(){for(var e=n.length,i=new t.Stream,s=[],a=e;a-->0;)s[a]=i.listen();for(var a=e;a-->1;){var c=function(t,e){return o.push(e),s[t-1].pause(),s[t].resume(),o};s[a-1].pause(),s[a-1].then(c.bind(c,a))}s[e-1].pause(),s[e-1].then(function(t){o.push(t),s[e-1].pause(),s[0].resume(),r.add(o),o=[]}),n.map(function(t,e){t.then(function(t){i.add(t)})}),s[0].resume()}}return __extends(n,e),n}(t.Stream);t.Order=e}(Mist||(Mist={}));var Mist;!function(t){var e=function(t){function e(e){var n=this;t.call(this);var r=[];this.initialize=function(){var t=e.length;e.map(function(e,o){e.then(function(e){r[o]=e,1==r.length&&n.add(e),r.length==t&&(r=[])})})}}return __extends(e,t),e}(t.Stream);t.Race=e}(Mist||(Mist={}));var Mist;!function(t){var e=function(){function e(e){this.value=new t.Value(function(){var t=getComputedStyle(e),n=(t.transform||t.mozTransform||t.webkitTransform).match(/matrix\((.*?)\)/);return n?n[1].split(/\s?,\s?/).map(parseFloat):[1,0,0,1,0,0]}()),this.value.then(function(t){var n=getComputedStyle(e),r=n.transform||n.mozTransform||n.webkitTransform;r=[r.replace(/(matrix\(.*?\)|none)/,""),["matrix(",t.join(),")"].join("")].join(" "),e.style.transform=r,e.style.mozTransform=r,e.style.webkitTransform=r})}return e.prototype.add=function(t){this.value.compose(function(e){return[e[0]+(t[0]||0),e[1]+(t[1]||0),e[2]+(t[2]||0),e[3]+(t[3]||0),e[4]+(t[4]||0),e[5]+(t[5]||0)]})},e.prototype.get=function(){return this.value.composite},e.prototype.set=function(t){this.value.compose(function(n){return[e.assert(t[0],n[0]),e.assert(t[1],n[1]),e.assert(t[2],n[2]),e.assert(t[3],n[3]),e.assert(t[4],n[4]),e.assert(t[5],n[5])]})},e.assert=function(t,e){return null!=t?t:e},e}();t.Matrix=e}(Mist||(Mist={}));var Mist;!function(t){var e=function(){function e(e){this.selector=e,this.cssc=new t.CSSClass(this),this.csss=new t.CSSStyle(this)}return e.prototype.all=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];return new t.All(this.listen(e)).listen()},e.prototype.each=function(t){[].forEach.call(this.query(),t)},e.prototype.emit=function(e,n){var r=t.Emitter.customize(e,{detail:n||{}});this.each(function(t){t.dispatchEvent(r)})},e.prototype.on=function(e){return t.Component.create(t.Emitter,e,this.selector).listen()},e.prototype.order=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];return new t.Order(this.listen(e)).listen()},e.prototype.race=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];return new t.Race(this.listen(e)).listen()},e.prototype.rotate=function(e){var n=[Math.cos(e),Math.sin(e),Math.sin(e)/-1,Math.cos(e),null,null];this.each(function(e){t.Component.create(t.Matrix,e).add(n)})},e.prototype.some=function(t){return[].some.call(this.query(),t)},e.prototype.translate=function(e,n){var r=[null,null,null,null,e,n];this.each(function(e){t.Component.create(t.Matrix,e).add(r)})},e.prototype.listen=function(t){var e=this;return t.map(function(t){return e.on(t)})},e.prototype.query=function(){return document.querySelectorAll(this.selector)},e}();t.Statement=e}(Mist||(Mist={}));