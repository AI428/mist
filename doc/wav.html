<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta name="desription" content="Behavior test">
    <title>MIST, Motion Design in Modular CSS</title>

    <!---->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css">

    <!---->
    <script src='../dist/mist.js'></script>
    <style>
        main {
            height: 64px;
            left: 50%;
            overflow: hidden;
            position: absolute;
            transform: translate3d(-50%, -50%, 0);
            top: 50%;
            width: 448px;
        }

        .wav {
            display: flex;
        }

        .wav>div {
            height: 100%;
            position: relative;
            width: calc(100% / 32);
        }

        .wav>div>i {
            bottom: 0;
            position: absolute;
            width: 100%;
        }

        .wav>div>i:before {
            background: inherit;
            content: '';
            height: 1px;
            position: absolute;
            width: 100%;
        }
    </style>
</head>

<body>
    <main class='wav'>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
        <div><i></i></div>
    </main>
    <script>
        (function() {

            var head = document.querySelector('.wav').clientHeight;

            var attacks = 100;
            var attack = {

                height: function() {

                    return Math.random() * 100 + '%';
                },

                transition: `${attacks}ms cubic-bezier(0.95, 0.05, 0.795, 0.035)`
            };

            var steps = 4;
            var releases = 500;
            var release = {

                background: function(element, i) {

                    var response = element.getBoundingClientRect();

                    return `hsl(${i}, ${((response.height / head) * 100)}%, 66%)`;
                },

                height: function(element) {

                    var response = element.getBoundingClientRect();

                    var min = response.height / steps;

                    mist(element).any(':before').set({
                        bottom: `${response.height}px`,
                        transition: 0
                    }).time(attacks).set({
                        bottom: `${min}px`,
                        transition: `${releases}ms steps(${response.height.toFixed(0)})`
                    });

                    return `${min}px`;
                },

                transition: `${releases}ms`
            };

            setInterval(

                function() {

                    mist('.wav> div> i').setAll(
                        attack
                    ).time(
                        attacks
                    ).setAll(
                        release
                    );

                }, 500);
        })();
    </script>
</body>

</html>
