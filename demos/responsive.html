<!DOCTYPE html>
<html>

<head>
  <title></title>
  <meta charset='UTF-8'>
  <meta name='apple-mobile-web-app-capable' content='yes'>
  <meta name='apple-mobile-web-app-status-bar-style' content='black'>
  <meta name='description' content=''>
  <meta name='mobile-web-app-capable' content='yes'>
  <meta name='MobileOptimized' content='320'>
  <meta name='viewport' content='maximum-scale=1.0,width=device-width'>
  <script src='../modules/mist.min.js'></script>
  <style>
    /** common statement */

    html,
    body {
      height: 100%;
      margin: 0;
      width: 100%;
    }

    .responsive {
      border: 1px solid rgba(0, 0, 0, .1);
      border-radius: 3px;
      left: 50%;
      height: 200px;
      overflow: hidden;
      position: absolute;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 400px;
    }
  </style>
</head>

<body>
  <div class='responsive'></div>
  <script>
    /** scoped statement */

    (function(main) {

      var pseudoElementA = main.concat('::after');
      var pseudoElementB = main.concat('::before');

      // ev response.

      var panend = mist('*').on('panend');
      var panned = main.on('panned');
      var panstart = main.on('panstart');

      panstart.when(

        function() {

          pseudoElementA.style.set({

            borderRadius: '50%',
            bottom: 0,
            content: '""',
            left: '50%',
            position: 'absolute',
            right: '50%',
            opacity: 0,
            top: 0

          }).then(

            function() {

              pseudoElementA.style.add({

                borderRadius: 0,
                left: 0,
                right: 0,
                transition: 'all .8s'

              });

              pseudoElementA.style.add({

                backgroundColor: '#000',
                opacity: .1

              }, 18).then(

                function() {

                  main.emitter.emit('panned');
                });
            });

          pseudoElementB.style.set({

            bottom: 0,
            content: '""',
            left: 0,
            position: 'absolute',
            right: 0,
            opacity: 0,
            top: 0,
            transition: 'all .8s'

          }).then(

            function() {

              pseudoElementB.style.add({

                backgroundColor: '#000',
                opacity: .1

              });
            });

          main.style.set({

            transition: 'all .8s'

          }).then(

            function() {

              main.style.add({

                boxShadow: '0 1px 4px #222'

              });
            });

          panend.resume();
          panned.resume();

          Mist.Promise.all([

            panend,
            panned

          ]).then(

            function() {

              pseudoElementB.style.add({

                opacity: 0

              });

              main.style.add({

                boxShadow: 'none'

              });
            });
        });

    })(mist('.responsive'));
  </script>
</body>

</html>
